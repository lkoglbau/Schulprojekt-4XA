@model Schulprojekt.Models.Product

<h2>@Model.Name</h2>

<div class="row">
    <div class="col-md-6">
        <img src="~/images/@Model.ImageName" class="card-img-top" alt="@Model.Name" />

    </div>
    <div class="col-md-6">
        <h4>Preis: @Model.Price.ToString("C")</h4>
        <p>@Model.Description</p>
        <p><strong>Kategorie:</strong> @Model.Category?.Name</p>
        <form asp-controller="Cart" asp-action="Add" method="post">
            <input type="hidden" name="productId" value="@Model.Id" />
            <button type="submit" class="btn btn-success">In den Warenkorb</button>
        </form>
    </div>
</div>

<hr />
<h4>Bewertung abgeben</h4>

<form asp-action="AddReview" method="post">
    <input type="hidden" name="productId" value="@Model.Id" />

    <div class="mb-2">
        <label for="rating">Sterne:</label>
        <select name="rating" class="form-select" required>
            <option value="5">★★★★★</option>
            <option value="4">★★★★</option>
            <option value="3">★★★</option>
            <option value="2">★★</option>
            <option value="1">★</option>
        </select>
    </div>

    <div class="mb-2">
        <label for="comment">Kommentar:</label>
        <textarea name="comment" class="form-control" rows="3" required></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Absenden</button>
</form>

<hr />

@if (Model.Reviews != null){
<h4>Bewertungen</h4>

    @foreach (var review in Model.Reviews.OrderByDescending(r => r.CreatedAd))
    {
        <div class="border rounded p-2 mb-2">
            <strong>@review.User?.UserName</strong> – @review.CreatedAd.ToShortDateString()<br />
            <span>
                @for (int i = 0; i < review.Rating; i++)
                {
                    <text>★</text>
                }
            </span>
            <p>@review.Comment</p>
        </div>
    }
}
else
{
    <p class="text-muted">Noch keine Bewertungen vorhanden.</p>
}